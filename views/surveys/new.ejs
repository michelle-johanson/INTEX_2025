<div class="page-container">

    <h1 class="page-title">Add Survey</h1>

    <form action="/surveys/new" method="POST" class="form">

        <label>Participant (Required)</label>
        <select name="ParticipantID" required>
            <option value="">Select a participant…</option>
            
            <% participants.forEach(p => { %>
                <option value="<%= p.participant_id %>">
                    <%= p.first_name %> <%= p.last_name %>
                </option>
            <% }) %>
        </select>

        <label>Event Occurrence (Required)</label>
        <select name="EventOccurrenceID" required>
            <option value="">Select an event…</option>
            
            <% occurrences.forEach(o => { %>
                <% const isSelected = (typeof selectedEvent !== 'undefined' && String(selectedEvent) === String(o.event_occurrence_id)); %>
                
                <option value="<%= o.event_occurrence_id %>" <%= isSelected ? 'selected' : '' %>>
                    <%= o.event_name %> — <%= new Date(o.starts_at).toLocaleString() %>
                </option>
            <% }) %>
        </select>

        <label>Satisfaction Score **(1-5)**</label>
        <input type="number" name="SurveySatisfactionScore" min="1" max="5" required />

        <label>Usefulness Score **(1-5)**</label>
        <input type="number" name="SurveyUsefulnessScore" min="1" max="5" required />

        <!-- NEW FIELD: Instructor Score -->
        <label>Instructor Score **(1-5)**</label>
        <input type="number" name="SurveyInstructorScore" min="1" max="5" required />

        <label>Recommendation Score **(1-5)**</label>
        <input type="number" name="SurveyRecommendationScore" min="1" max="5" required />

        <!-- REMOVED: Overall Score input, as it is now calculated -->

        <label>Comments</label>
        <textarea name="SurveyComments" rows="3"></textarea>

        <label>Submission Date</label>
        <input type="date" name="SurveySubmissionDate" value="<%= new Date().toISOString().split('T')[0] %>" required />

        <!-- #TO-DO: create class for flex container with gap: 1rem; align-items: center; -->
        <div class="d-flex mt-2">
            <button class="btn-submit">Submit Survey</button>
            <a href="/surveys">Cancel</a>
        </div>

    </form>

</div>