<section class="page-container">
    <div class="page-card-wide">

        <h2><%= event.name %></h2>

        <p class="text-muted">
            Type: <strong><%= event.type %></strong>
        </p>

        <p><%= event.description %></p>
        <% if (isManager) { %>
            <div class="btn-wrapper">
                <a href="/events/<%= event.event_id %>/edit" class="btn btn-edit btn-lg">
                    Edit Event Info
                </a>
        
                <form action="/events/<%= event.event_id %>/delete" method="POST">
                    <button class="btn btn-delete btn-lg" onclick="return confirm('Delete this event?');">
                        Delete Event Type
                    </button>
                </form>
            </div>
        <% } %>
    </div>
</section>

<section class="page-container">
<div class="container-inner">
    <div class="container-header mb-4">
        <h2>Event Occurrences</h2>
    </div>

    <!-- SCHEDULED OCCURRENCES -->
    <%- include("../partials/tableControls", {
        showAddButton: isManager,
        addHref: `/eventOccurrences/new?event_id=${event.event_id}`,
        addLabel: "Schedule New Occurrence",
        searchAction: `/events/${event.event_id}`,
        searchPlaceholder: "Search locationâ€¦",
        query: query   // your route must pass this
    }) %>

        <!-- TABLE -->
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Date & Time</th>
                    <th>Location</th>
                    <th>Capacity</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody>
                <% occurrences.forEach(o => { %>
                    <tr>
                        <td><%= o.starts_at %></td>
                        <td><%= o.location %></td>
                        <td><%= o.capacity %></td>
                        <td>
                            <a href="/eventOccurrences/<%= o.event_occurrence_id %>" 
                                class="btn btn-outline btn-table">
                                View
                            </a>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
</div>
</section>
