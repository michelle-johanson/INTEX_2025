<div class="page-container">

    <h1 class="page-title">Participant Directory</h1>

    <% const isManager = session.access_level && (session.access_level.toLowerCase() === "manager" || session.access_level.toLowerCase() === "admin"); %>

    <% if (isManager) { %>
        <a href="/participants/new" class="btn btn-primary btn-small mb-4">
            + Add Participant
        </a>
    <% } %>

    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>City</th>
                <th>Field of Interest</th>
                <th>Total Donations</th>
                <th></th>
            </tr>
        </thead>

        <tbody>
            <% participants.forEach(p => { %>
                <tr>
                    <td><%= p.first_name %> <%= p.last_name %></td>
                    <td><%= p.email %></td>
                    <td><%= p.city %>, <%= p.state %></td>
                    <td><%= p.field_of_interest %></td>
                    <td>$<%= p.total_donations || 0 %></td>

                    <td class="table-actions">
                        <a href="/participants/<%= p.participant_id %>" class="btn btn-secondary btn-small">
                            View
                        </a>
                    </td>
                </tr>
            <% }) %>
        </tbody>
    </table>

</div>