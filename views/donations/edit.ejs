<section class="page-container">
    <div class="page-card-form">

        <h1 class="page-title">Edit Donation</h1>

        <% 
            // Format YYYY-MM-DD safely
            const formatDate = (dateVal) => {
                if (!dateVal) return '';

                if (typeof dateVal === 'string') {
                    return dateVal.substring(0, 10);
                }

                if (dateVal instanceof Date && !isNaN(dateVal.getTime())) {
                    return dateVal.toISOString().split('T')[0];
                }

                return '';
            };
        %>

        <!-- FORM -->
        <form 
            action="/donations/<%= donation.participant_id %>/<%= donation.donation_no %>/edit" 
            method="POST"
            class="form"
        >

            <!-- DONOR INFO (READ ONLY) -->
            <label>Donor</label>
            <input 
                type="text"
                value="<%= donation.first_name %> <%= donation.last_name %> (ID #<%= donation.participant_id %>)"
                disabled
                class="input-disabled"
            />

            <!-- DONATION DATE -->
            <label for="DonationDate">Donation Date</label>
            <input 
                id="DonationDate" 
                type="date"
                name="DonationDate"
                value="<%= formatDate(donation.donation_date) %>"
                required
            />

            <!-- DONATION AMOUNT -->
            <label for="DonationAmount">Donation Amount (USD)</label>
            <input 
                id="DonationAmount"
                type="number"
                name="DonationAmount"
                min="1"
                step="0.01"
                value="<%= donation.amount %>"
                required
            />

            <!-- ACTION BUTTONS -->
            <div class="btn-wrapper" style="margin-top: 1.75rem;">
                <button type="submit" class="btn btn-primary btn-lg">
                    Save Changes
                </button>

                <a href="/donations" class="btn btn-secondary btn-lg">
                    Cancel
                </a>
            </div>

        </form>

    </div>
</section>
